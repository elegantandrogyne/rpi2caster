#include <stdio.h>
#include <io.h>
#include <string.h>
#include <conio.h>
#include <dos.h>
#include <stdlib.h>
#include <fcntl.h>          /* O_ constant definitions */
#include <process.h>
#include <bios.h>

#include <graph.h>
#include <ctype.h>
#include <fcntl.h>
#include <time.h>
#include <sys\types.h>
#include <sys\stat.h>
#include <malloc.h>
#include <errno.h>

typedef struct matrijs {
     char lig[4];  /* string present in mat
		      4 bytes: for unicode
		      otherwise 3 asc...
		      */
     unsigned char srt;      /* 0=romein 1=italic 2= kk 3=bold */
     unsigned int  w;        /*

	      in a future version, this could be an int:
		   100 * 23 = 2300
	      calculations in 1/100 of an unit... is accurate enough
		 width in units  */

     unsigned char mrij  ;   /* place in mat-case   */
     unsigned char mkolom;   /* place in mat-case   */
};

typedef struct rec02 {
	     char cnaam[34];
    unsigned char wedge[RIJAANTAL];
    unsigned char corps[10];
    unsigned char csets[10];
} ;

typedef struct gegevens {
    unsigned char set ;     /* 4 times set                */
    unsigned int  matrices; /* total number of matrices   */
    unsigned char syst;     /* 0 = 15*15 NORM
			       1 = 17*15 NORM2
			       2 = 17*16 MNH
			       3 = 17*16 MNK
			       4 = 17*16 SHIFT
			       */
    unsigned char adding;      /* 0,1,2,3 >0 adding = on     */
    char          pica_cicero; /* p = pica,  d = didot  f = fournier  */
    float         corp;        /*  5 - 14 in points          */
    float         rwidth;      /* width in pica's/cicero     */
    float    inchwidth;        /* width in line in inches    */
    unsigned int  lwidth;      /* width of the line in units */
    unsigned char fixed;       /*  'n' / 'y' fixed spaces 1/2 corps height */
    unsigned char right;       /* r_ight, l_eft, f_lat, c_entered */
    unsigned char d_style;     /* dominant style */



    unsigned char ppp;         /* . . .
				3u + . 3 . 3 . 3.
				3u + !
				3u + ?
			       y/n */
};

/*
     baskerville:

     8 -> 8.25 set 33
     9 -> 9 set    36
    10 -> 10.75    43
    12 -> 12       48

 */

struct gegevens central = { 48,     /* set 12        47*/
			    272,    /* mats  15*17 = 255, 272 = 16*17  */
			    NORM2,
			    0,      /* nu unit adding  */
			    'd',    /* didot          */
			    12.0,   /* corps        */
   /* 20.,   16 width     */  24.,    /*   28.,      30.,    25.,    24.,    */
   /* 3.552, 2.8416 inch width*/   4.26,/*  4.9728,   5.328,  4.44,     4.2624,*/
   /*449.,  359.  units   */ 460.,    /* 629.,    674.,   561.,     539.,    */
			    'n',
			    'r',
			    '0', /* dominant style */
			    'n' } ;



struct matrijs far matrix[272]  = {
/*    NI            NL               A              B           C
      D             E                F              G           H
      I             J                K              L           M
      N             O   */

".", 1,5 , 0, 2, ".",2,5,0, 2,
"-", 1, 7, 1, 6,  "-",2, 7, 1, 6,
"=", 0, 5, 0, 8, /* vaste spatie */
"--", 0,9, 6, 0, "--", 1, 9, 6, 0, "--", 2,9,6,0,
"\047",0,5,0,5, "\047",1,5,0,5, /* ' = 39 = 0x27 = \047 = asc */
",",1,5, 0,3, ",",2,5,0, 3,

"",0,18,15, 2,
"u", 0,10, 7,12,

/* 1 */
"f",0,5, 0, 0,  "j",1,5, 0, 1, ".",0,5, 0, 2, ",",0,5, 0, 3, "i",2,5, 0, 4,
"'",0,5, 0, 5,  "j" ,0,5, 0, 6, "i",0,5, 0, 7, " ",0,5, 0, 8,"l",0,5, 0, 9,
/* i^ @8c */
"\214",0,5, 0,10,  "e",4,5, 0,11,  "i",4,5, 0,12, "i",1,5, 0,13, "l",1,5, 0,14,
"t",1,5, 0,15,  "",0,5, 0,16,

/* 2 */                         /* e^*/      /*i^*/
"f",1,6, 1, 0, "\207",1,6, 1, 1, "\214",1, 6,1,2, "",1,6, 1, 3, "s",0,6, 1, 4,
"t",0,6, 1, 5, "-",0,5, 1, 6, "r",1, 6,1, 7, " ",0,6, 1, 8, "e",1,6, 1, 9,
"r",4,5, 1,10, "s",4,5, 1,11, "s",1,6, 1,12, "c",1,6, 1,13, "\212",1,6, 1,14,
"\202",1,6, 1,15, "",0,6, 1,16,

/* 3 */
"!",1,7, 2, 0, "v",1,7, 2, 1, "!",0,7, 2, 2, "(",0,7, 2, 3, ")",0,7, 2, 4,
"d",1,8, 2, 5, ":",0,7, 2, 6, ";",0,7, 2, 7, "r",0,7, 2, 8, "y",1,7, 2, 9,
"o",1,7, 2,10, "o",4,7, 2,11, "\242",1,7, 2,12, "I",1,7, 2,13, ";",1,7, 2,14,
":",1,7, 2,15, "",0,7, 2,16,
/* 4 */
"\256",0,8, 3, 0, "\257",0,8, 3, 1, "J",0,8, 3, 2, "z",0,8, 3, 3, "c",0,8, 3, 4,
"\202",0,8, 3, 5, "e",0,8, 3, 6, "n",1,8, 3, 7, "p",1,8, 3, 8, "u",1,8, 3, 9,
"h",1,8, 3,10, "''",0,8, 3,11, "fl",1,8, 3,12, "fi",1,8, 3,13, "\226",1,8, 3,14,
"\201",1,8, 3,15, /*"\227"*/ "",1,8, 3,16,
/* 5 */

"\211",0,8, 4, 0, "\207",0,8, 4, 1, "\227",1,8, 4, 2, "I",0,8, 4, 3, "\210",0,8, 4, 4,
"\212",0,8, 4, 5, "k",1,8, 4, 6, "q",1,8, 4, 7, " ",0,8, 4, 8, "g",1,8, 4, 9,
							 /* a^ */
"b",1,8, 4,10, "",0,8, 4,11, "z",1,8, 4,12, "x",1,8, 4,13, "\203",1,8, 4,14,
/* a" */          /* a` */
"\204",1,8, 4,15, /*"\205"*/ "",1,8, 4,16,

/* 6  o" */                                                     /* a^ */
"\224",0,9, 5, 0, " . ",0,9, 5, 1, "\205",1,8, 5, 2, "b",2,9, 5, 3, "\203",0,9, 5, 4,
	       /* a^ */
"8",0,9, 5, 5, "\203",0,9, 5, 6, "x",0,9, 5, 7, "a",1,9, 5, 8, "v",0,9, 5, 9,
"z",2,9, 5,10, "2",0,9, 5,11, "ff",1,9, 5,12, "5",1,9, 5,13, "7",1,9, 5,14,
"9",0,9, 5,15, "",0,9, 5,16,

/* 7 */         /* a" */
"--", 0,9, 6, 0, "\204",0,9, 6, 1, "oe!",1,9, 6, 2, "e", 2,9, 6, 3, "p",2,9, 6, 4,
"\223",  1,9, 6, 5, "y",0,9, 6, 6, "a", 0,9, 6, 7, "o", 0,9, 6, 8, "g", 0,9, 6, 9,
				/* u` */
"k",   0,9, 6,10, "4",0,9, 6,11, "\227",0,10, 6,12, "6",0,9, 6,13, "1", 1,9, 6,14,
       /* foutje was:oe!",2,... */
"0",2,9, 6,15, "",1,9, 6,16,

/* 8 e` */
"\212",2,10, 7, 0, "(",1,10, 7, 1, ")",1,10, 7, 2, "v",2,10, 7, 3, "r",2,10, 7, 4,
"d", 2,10, 7, 5, "q",0,10, 7, 6, "p", 0,10, 7, 7, "h", 0,10, 7, 8, "n",0,10, 7, 9,
								   /* u^ */
"b", 0,10, 7,10, "*",0,10, 7,11,  /*"u", 0,10, 7,12,*/ "fl",0,10, 7,13, "\226",0,10, 7,14,
"S",0,10, 7,15, "",1,10, 7,16,
/* 9 e^ */
"\210",2,10, 8, 0, "``",0,10, 8, 1, "?", 1,8, 8, 2, "y", 2,10, 8, 3, "n",2,10, 8, 4,
"a",2,10, 8, 5, "g",2,10, 8, 6, "u",2,10, 8, 7, "o",2,10, 8, 8, "k",2,10, 8, 9,
			       /* u" */
"d",0,10, 8,10, "3",0,10, 8,11, "\201", 0,10, 8,12, "fi", 0,10, 8,13, "?",0,8, 8,14,
"S",1,10, 8,15, "",1,8, 8,16,
/* 10 */
"ff",0,11, 9, 0, "",0,11, 9, 1, "Y",1,11, 9, 2, "Z",1,12, 9, 3, "P",0,11, 9, 4,
"B",0,11, 9, 5, "F",0,11, 9, 6, "F",1,11, 9, 7, "",0,11, 9, 8, "J",1,11, 9, 9,
"\200",1,11, 9,10, "",0,11, 9,11, "L",1,11, 9,12, "C",1,11, 9,13, "P",1,11, 9,14,
"V",1,11, 9,15, "Y",1,11, 9,16,

/* 11          E^*/
"",0,12,10, 0, "\322",0,12,10, 1, "L",0,12,10, 2, "E",0,12,10, 3, "ffi",1,12,10, 4,
						 /* E' */
"ffl",1,12,10, 5, "E",1,12,10, 6, "A",1,12,10, 7, "\220",0,12,10, 8, "m",1,12,10, 9,
	       /* E` */
"w",1,12,10,10, "\324",0,12,10,11, "Z",0,12,10,12, "R",1,12,10,13, "B",1,12,10,14,
"G",1,12,10,15, "",1,12,10,16,

/* 12 A" */
"\216",0,13,11, 0, "\221",  2,13,11, 1, "T",0,13,11, 2, "C",0,13,11, 3, "",0,13,11, 4,
"w",  0,13,11, 5, "A",0,13,11, 6, "\200",0,13,11, 7, "Y",0,13,11, 8, "Q",1,13,11, 9,
"",  0,13,11,10, "",  0,13,11,11, "",0,13,11,12, "O",1,13,11,13, "K",1,13,11,14,
"X",  1,13,11,15, "",  0,13,11,16,

/* 13 */
"oe!",2,14,12, 0, "w",  2,14,12, 1, "V",0,14,12, 2, "G",0,14,12, 3, "D",0,14,12, 4,
"R",0,14,12, 5, "N",  0,14,12, 6, "oe!",0,14,12, 7, "",0,14,12, 8, "H",1,14,12, 9,
	      /* U"*/
"",0,14,12,10, "\232",1,14,12,11, "D",1,14,12,12, "T",1,14,12,13, "N",1,14,12,14,
"U",1,14,12,15, "", 1,14,12,16,

/* 14 */
"",0,15,13, 0,  "",0,15,13, 1, "m",0,15,13, 2, "&",0,15,13, 3, "X",0,15,13, 4,
"K",0,15,13, 5, "H",0,15,13, 6, "O",0,15,13, 7, "\232",0,15,13, 8, "U",0,15,13, 9,
/* O" */
"\231",0,15,13,10, "",0,15,13,11, "ffi",0,15,13,12, "ffl",0,15,13,13, "Q",0,15,13,14,
"",0,15,13,15, "",0,15,13,16,
/* 15 */
"+",  0,18,14, 0, "OE!", 0,18,14, 1, "W",1,20,14, 2, "\222",1,18,14, 3, "%",0,18,14, 4,
"W",  0,18,14, 5, "",  0,18,14, 6, "M", 0,20,14, 7, "",0,20,14, 8, "M",1,18,14, 9,
"OE!",  1,18,14,10, "",1,18,14,11, "&",1,18,14,12, "\222", 1,18,14,13, "",0,23,14,14,
"---",1,20,14,15, " ",  4,18,14,16,
/* 16 */
  "",0,18,15, 3, "",0,18,15, 4,
 "", 0,18, 15,15, "",0,18,15,16


} ;

